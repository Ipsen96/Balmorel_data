PARAMETER DECOM_G(YYY,YYY,AAA,GGG)  'DECOMMISIONING YEAR OF ENDOGENOUS GENERATION INVESTMENTS DEPENDING ON INVESTMENT YEAR';                                                                                                                                               
                                                                                                                                                                                                                                                                           
LOOP(C,                                                                                                                                                                                                                                                                    
         LOOP((AAA,G)$(AGKN(AAA,G) AND ICA(C,AAA)),                                                                                                                                                                                                                        
                 LOOP(IYALIAS,                                                                                                                                                                                                                                             
                         LOOP(Y$(ORD(Y) EQ ORD(IYALIAS)),                                                                                                                                                                                                                  
                                 IINVYEARG_LEFT(C,IYALIAS,Y,G)=GDATA(G,'GDLIFETIME');                                                                                                                                                                                      
                         );                                                                                                                                                                                                                                                
                 );                                                                                                                                                                                                                                                        
         );                                                                                                                                                                                                                                                                
);                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                           
LOOP(C,                                                                                                                                                                                                                                                                    
LOOP((AAA,G)$(AGKN(AAA,G) AND ICA(C,AAA)),                                                                                                                                                                                                                                 
         LOOP(IYALIAS,                                                                                                                                                                                                                                                     
                  IN_INV_G(C,IYALIAS,G)=ROUND(IWEIGHTY(IYALIAS)/GDATA(G,'GDLIFETIME'));                                                                                                                                                                                    
*Correction of IN_INV_G                                                                                                                                                                                                                                                    
                  IF ( IN_INV_G(C,IYALIAS,G) EQ 0,                                                                                                                                                                                                                         
                              IN_INV_G(C,IYALIAS,G)=1;                                                                                                                                                                                                                     
                  );                                                                                                                                                                                                                                                       
                  LOOP(Y$(ORD(Y) GE ORD(IYALIAS)),                                                                                                                                                                                                                         
*First year                                                                                                                                                                                                                                                                
                        IF ( ORD(Y) EQ ORD(IYALIAS),                                                                                                                                                                                                                       
                              IF(IINVYEARG_LEFT(C,IYALIAS,Y,G)*IN_INV_G(C,IYALIAS,G) LE IWEIGHTY(Y),                                                                                                                                                                       
                                 DECOM_G(IYALIAS,Y+1,AAA,G)$(ORD(Y) NE CARD(IYALIAS2))=1;                                                                                                                                                                                  
                                 BREAK;                                                                                                                                                                                                                                    
                              );                                                                                                                                                                                                                                           
                              IINVYEARG_LEFT(C,IYALIAS,Y+1,G)$(ORD(Y) NE CARD(IYALIAS2))=GDATA(G,'GDLIFETIME')*IN_INV_G(C,IYALIAS,G)-IWEIGHTY(Y);                                                                                                                          
                         );                                                                                                                                                                                                                                                
*Remaining year                                                                                                                                                                                                                                                            
                        IF ( ORD(Y) GT ORD(IYALIAS),                                                                                                                                                                                                                       
                              IF ( IINVYEARG_LEFT(C,IYALIAS,Y,G) GT IWEIGHTY(Y) ,                                                                                                                                                                                          
                                   IINVYEARG_LEFT(C,IYALIAS,Y+1,G)$(ORD(Y) NE CARD(IYALIAS2))=IINVYEARG_LEFT(C,IYALIAS,Y,G)-IWEIGHTY(Y);                                                                                                                                   
                              );                                                                                                                                                                                                                                           
                             IF ( (IINVYEARG_LEFT(C,IYALIAS,Y,G) GE IWEIGHTY(IYALIAS)/2) AND (IINVYEARG_LEFT(C,IYALIAS,Y,G) LE IWEIGHTY(Y)) ,  !!Assumption: if the reamining years are more ore equal than half of IWEIGHTY, then the technology is in in this snapshot   
                                 DECOM_G(IYALIAS,Y+1,AAA,G)=1;                                                                                                                                                                                                             
                                   BREAK;                                                                                                                                                                                                                                  
                              );                                                                                                                                                                                                                                           
                              IF ( (IINVYEARG_LEFT(C,IYALIAS,Y,G) LT IWEIGHTY(IYALIAS)/2) AND (IINVYEARG_LEFT(C,IYALIAS,Y,G) LE IWEIGHTY(Y)) , !!Assumption: if the reamining years are less than half of IWEIGHTY, then the technology is out in this snapshot            
                                 DECOM_G(IYALIAS,Y,AAA,G)=1;                                                                                                                                                                                                               
                                   BREAK;                                                                                                                                                                                                                                  
                              );                                                                                                                                                                                                                                           
                        );                                                                                                                                                                                                                                                 
                 );                                                                                                                                                                                                                                                        
         );                                                                                                                                                                                                                                                                
);                                                                                                                                                                                                                                                                         
);                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                           
