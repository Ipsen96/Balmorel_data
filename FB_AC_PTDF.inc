SET                                                                                                                                                 ACNETWORKS                           'Defines the three AC-Subnetworks in Scandinavia, central Europe and Baltics defined by the PyPSA clustering'
/
ACSCAND
ACEUR
ACBALT
/
;



*SET                                                                                                                                                 RRR                                  'All regions included in the AC-power flow calculation'
*/
*DK2
*FIN
*NO1
*NO2
*NO3
*NO4
*NO5
*SE1
*SE2
*SE3
*SE4
*DK1
*DE4-N
*DE4-E
*DE4-S
*DE4-W
*NL
*PL
*UK
*BE
*FR
*EE
*LV
*LT
*/
*;


ALIAS (RRR,IRRRALIAS);



SET LINES                                                                                                                                           All AC lines in the Balmorel system'
/
ACLine1                                                                                                                                             '*                                                                                                                                                 DK6 0                        SE6 4         '
ACLine2                                                                                                                                             '*                                                                                                                                                 FI6 0                        NO6 4         '
ACLine3                                                                                                                                             '*                                                                                                                                                 FI6 0                        SE6 1         '
ACLine4                                                                                                                                             '*                                                                                                                                                 FI6 0                        SE6 3         '
ACLine5                                                                                                                                             '*                                                                                                                                                 NO6 1                        NO6 2         '
ACLine6                                                                                                                                             '*                                                                                                                                                 NO6 1                        NO6 3         '
ACLine7                                                                                                                                             '*                                                                                                                                                 NO6 1                        NO6 5         '
ACLine8                                                                                                                                             '*                                                                                                                                                 NO6 1                        SE6 3         '
ACLine9                                                                                                                                             '*                                                                                                                                                 NO6 2                        NO6 5         '
ACLine10                                                                                                                                            '*                                                                                                                                                 NO6 3                        NO6 4         '
ACLine11                                                                                                                                            '*                                                                                                                                                 NO6 3                        NO6 5         '
ACLine12                                                                                                                                            '*                                                                                                                                                 NO6 3                        SE6 2         '
ACLine13                                                                                                                                            '*                                                                                                                                                 NO6 4                        SE6 1         '
ACLine14                                                                                                                                            '*                                                                                                                                                 NO6 4                        SE6 2         '
ACLine15                                                                                                                                            '*                                                                                                                                                 SE6 1                        SE6 2         '
ACLine16                                                                                                                                            '*                                                                                                                                                 SE6 2                        SE6 3         '
ACLine17                                                                                                                                            '*                                                                                                                                                 SE6 3                        SE6 4         '
ACLine18                                                                                                                                            '*                                                                                                                                                 BE                           FR            '
ACLine19                                                                                                                                            '*                                                                                                                                                 BE                           NL            '
ACLine20                                                                                                                                            '*                                                                                                                                                 DE4-S                        DE4-W         '
ACLine21                                                                                                                                            '*                                                                                                                                                 DE4-S                        DE4-E         '
ACLine22                                                                                                                                            '*                                                                                                                                                 DE4-S                        FR            '
ACLine23                                                                                                                                            '*                                                                                                                                                 DE4-W                        DE4-E         '
ACLine24                                                                                                                                            '*                                                                                                                                                 DE4-W                        DE4-N         '
ACLine25                                                                                                                                            '*                                                                                                                                                 DE4-W                        NL            '
ACLine26                                                                                                                                            '*                                                                                                                                                 DE4-E                        DE4-N         '
ACLine27                                                                                                                                            '*                                                                                                                                                 DE4-E                        PL            '
ACLine28                                                                                                                                            '*                                                                                                                                                 DE4-N                        DK1           '
ACLine29                                                                                                                                            '*                                                                                                                                                 EE                           LV            '
ACLine30                                                                                                                                            '*                                                                                                                                                 LT                           LV            '
/
;



ALIAS(LINES,ILINES);

SET LINESRRR(LINES,IRRRE,IRRRI)                                                                                                                                                              'AC lines which are connecting regions'
/
ACLine1                                                                                                                                             .                                    DK2                                                                                                          .                            SE4
ACLine2                                                                                                                                             .                                    FIN                                                                                                          .                            NO4
ACLine3                                                                                                                                             .                                    FIN                                                                                                          .                            SE1
ACLine4                                                                                                                                             .                                    FIN                                                                                                          .                            SE3
ACLine5                                                                                                                                             .                                    NO1                                                                                                          .                            NO2
ACLine6                                                                                                                                             .                                    NO1                                                                                                          .                            NO3
ACLine7                                                                                                                                             .                                    NO1                                                                                                          .                            NO5
ACLine8                                                                                                                                             .                                    NO1                                                                                                          .                            SE3
ACLine9                                                                                                                                             .                                    NO2                                                                                                          .                            NO5
ACLine10                                                                                                                                            .                                    NO3                                                                                                          .                            NO4
ACLine11                                                                                                                                            .                                    NO3                                                                                                          .                            NO5
ACLine12                                                                                                                                            .                                    NO3                                                                                                          .                            SE2
ACLine13                                                                                                                                            .                                    NO4                                                                                                          .                            SE1
ACLine14                                                                                                                                            .                                    NO4                                                                                                          .                            SE2
ACLine15                                                                                                                                            .                                    SE1                                                                                                          .                            SE2
ACLine16                                                                                                                                            .                                    SE2                                                                                                          .                            SE3
ACLine17                                                                                                                                            .                                    SE3                                                                                                          .                            SE4
ACLine18                                                                                                                                            .                                    BE                                                                                                           .                            FR
ACLine19                                                                                                                                            .                                    BE                                                                                                           .                            NL
ACLine20                                                                                                                                            .                                    DE4-S                                                                                                        .                            DE4-W
ACLine21                                                                                                                                            .                                    DE4-S                                                                                                        .                            DE4-E
ACLine22                                                                                                                                            .                                    DE4-S                                                                                                        .                            FR
ACLine23                                                                                                                                            .                                    DE4-W                                                                                                        .                            DE4-E
ACLine24                                                                                                                                            .                                    DE4-W                                                                                                        .                            DE4-N
ACLine25                                                                                                                                            .                                    DE4-W                                                                                                        .                            NL
ACLine26                                                                                                                                            .                                    DE4-E                                                                                                        .                            DE4-N
ACLine27                                                                                                                                            .                                    DE4-E                                                                                                        .                            PL
ACLine28                                                                                                                                            .                                    DE4-N                                                                                                        .                            DK1
ACLine29                                                                                                                                            .                                    EE                                                                                                           .                            LV
ACLine30                                                                                                                                            .                                    LT                                                                                                           .                            LV
/
;

SET LINESRRRAC(LINES,IRRRE,IRRRI)                                                                                                                                                              'AC lines which are connecting regions'
/
ACLine1                                                                                                                                             .                                    DK2                                                                                                          .                            SE4
ACLine2                                                                                                                                             .                                    FIN                                                                                                          .                            NO4
ACLine3                                                                                                                                             .                                    FIN                                                                                                          .                            SE1
ACLine5                                                                                                                                             .                                    NO1                                                                                                          .                            NO2
ACLine6                                                                                                                                             .                                    NO1                                                                                                          .                            NO3
ACLine7                                                                                                                                             .                                    NO1                                                                                                          .                            NO5
ACLine8                                                                                                                                             .                                    NO1                                                                                                          .                            SE3
ACLine9                                                                                                                                             .                                    NO2                                                                                                          .                            NO5
ACLine10                                                                                                                                            .                                    NO3                                                                                                          .                            NO4
ACLine11                                                                                                                                            .                                    NO3                                                                                                          .                            NO5
ACLine12                                                                                                                                            .                                    NO3                                                                                                          .                            SE2
ACLine13                                                                                                                                            .                                    NO4                                                                                                          .                            SE1
ACLine14                                                                                                                                            .                                    NO4                                                                                                          .                            SE2
ACLine15                                                                                                                                            .                                    SE1                                                                                                          .                            SE2
ACLine16                                                                                                                                            .                                    SE2                                                                                                          .                            SE3
ACLine18                                                                                                                                            .                                    BE                                                                                                           .                            FR
ACLine19                                                                                                                                            .                                    BE                                                                                                           .                            NL
ACLine20                                                                                                                                            .                                    DE4-S                                                                                                        .                            DE4-W
ACLine21                                                                                                                                            .                                    DE4-S                                                                                                        .                            DE4-E
ACLine22                                                                                                                                            .                                    DE4-S                                                                                                        .                            FR
ACLine23                                                                                                                                            .                                    DE4-W                                                                                                        .                            DE4-E
ACLine24                                                                                                                                            .                                    DE4-W                                                                                                        .                            DE4-N
ACLine25                                                                                                                                            .                                    DE4-W                                                                                                        .                            NL
ACLine26                                                                                                                                            .                                    DE4-E                                                                                                        .                            DE4-N
ACLine27                                                                                                                                            .                                    DE4-E                                                                                                        .                            PL
ACLine28                                                                                                                                            .                                    DE4-N                                                                                                        .                            DK1
ACLine29                                                                                                                                            .                                    EE                                                                                                           .                            LV
ACLine30                                                                                                                                            .                                    LT                                                                                                           .                            LV
/
;


SET AC2RRR(ACNETWORKS,RRR)                                                                                                                                                               'Coupling networks and regions'
/
ACSCAND                                                                                                                                             .                                    (                                                                                                            DK2                       )
ACSCAND                                                                                                                                             .                                    (                                                                                                            FIN                       )
ACSCAND                                                                                                                                             .                                    (                                                                                                            NO1                                                             )
ACSCAND                                                                                                                                             .                                    (                                                                                                            NO2                                                                    )
ACSCAND                                                                                                                                             .                                    (                                                                                                            NO3                                                                    )
ACSCAND                                                                                                                                             .                                    (                                                                                                            NO4                                                                 )
ACSCAND                                                                                                                                             .                                    (                                                                                                            NO5                                                                   )
ACSCAND                                                                                                                                             .                                    (                                                                                                            SE4                                                             )
ACSCAND                                                                                                                                             .                                    (                                                                                                            SE1                                                                    )
ACSCAND                                                                                                                                             .                                    (                                                                                                            SE2                                                                )
ACSCAND                                                                                                                                             .                                    (                                                                                                            SE3                                                                   )
ACEUR                                                                                                                                               .                                    (                                                                                                            DK1                                                            )
ACEUR                                                                                                                                               .                                    (                                                                                                            BE                                                                  )
ACEUR                                                                                                                                               .                                    (                                                                                                            NL                                                                   )
ACEUR                                                                                                                                               .                                    (                                                                                                            FR                                                            )
ACEUR                                                                                                                                               .                                    (                                                                                                            PL                                                             )
ACEUR                                                                                                                                               .                                    (                                                                                                            DE4-S                                                          )
ACEUR                                                                                                                                               .                                    (                                                                                                            DE4-W                                                             )
ACEUR                                                                                                                                               .                                    (                                                                                                            DE4-N                                                         )
ACEUR                                                                                                                                               .                                    (                                                                                                            DE4-E                                                            )
ACBALT                                                                                                                                              .                                    (                                                                                                            EE                                                                     )
ACBALT                                                                                                                                              .                                    (                                                                                                            LT                                                             )
ACBALT                                                                                                                                              .                                    (                                                                                                            LV                                                             )

/
;

SET AC2LINES(LINES,ACNETWORKS)                                                                                                                                                           'AC lines connected to AC networks'
/
ACLine1                                                                                                                                             .                                    ACSCAND
ACLine2                                                                                                                                             .                                    ACSCAND
ACLine3                                                                                                                                             .                                    ACSCAND
ACLine4                                                                                                                                             .                                    ACSCAND
ACLine5                                                                                                                                             .                                    ACSCAND
ACLine6                                                                                                                                             .                                    ACSCAND
ACLine7                                                                                                                                             .                                    ACSCAND
ACLine8                                                                                                                                             .                                    ACSCAND
ACLine9                                                                                                                                             .                                    ACSCAND
ACLine10                                                                                                                                            .                                    ACSCAND
ACLine11                                                                                                                                            .                                    ACSCAND
ACLine12                                                                                                                                            .                                    ACSCAND
ACLine13                                                                                                                                            .                                    ACSCAND
ACLine14                                                                                                                                            .                                    ACSCAND
ACLine15                                                                                                                                            .                                    ACSCAND
ACLine16                                                                                                                                            .                                    ACSCAND
ACLine17                                                                                                                                            .                                    ACSCAND
ACLine18                                                                                                                                            .                                    ACEUR
ACLine19                                                                                                                                            .                                    ACEUR
ACLine20                                                                                                                                            .                                    ACEUR
ACLine21                                                                                                                                            .                                    ACEUR
ACLine22                                                                                                                                            .                                    ACEUR
ACLine23                                                                                                                                            .                                    ACEUR
ACLine24                                                                                                                                            .                                    ACEUR
ACLine25                                                                                                                                            .                                    ACEUR
ACLine26                                                                                                                                            .                                    ACEUR
ACLine27                                                                                                                                            .                                    ACEUR
ACLine28                                                                                                                                            .                                    ACEUR
ACLine29                                                                                                                                            .                                    ACBALT
ACLine30                                                                                                                                            .                                    ACBALT
/
;

Parameter
FB_ACPTDF(ACNETWORKS,LINES,RRR)                                                                                                                                                                                                                                                                       ;
TABLE                                                                                                                                               FB_ACPTDF_ACSCAND(LINES,RRR)                                                                                                                                                                          PTDF of the Scandinavian network'
                                                                                                                                                    DK2                                  FIN                                                                                                          NO1                          NO2                NO3         NO4                               NO5                SE1         SE2                SE3          SE4
ACLine1                                                                                                                                             0                                    -1                                                                                                           -1                           -1                 -1          -1                                -1                 -1          -1                 -1           -1
ACLine2                                                                                                                                             0                                    0.0723919                                                                                                    -0.00849931                  -0.00872469        -0.0206344  -0.0649867                        -0.00997935        0.00281924  -0.00279592        0            6.93889e-18
ACLine3                                                                                                                                             0                                    0.617957                                                                                                     -0.0126498                   -0.0129852         -0.0307107  -0.0472441                        -0.0148526         -0.136214   -0.0430646         0            0
ACLine4                                                                                                                                             0                                    0.309651                                                                                                     0.0211491                    0.0217099          0.0513451   0.112231                          0.0248319          0.133394    0.0458605          -1.11022e-16 0
ACLine5                                                                                                                                             0                                    -0.0076624                                                                                                   0.0213065                    -0.84601           -0.0344716  -0.0160601                        -0.107362          -0.0089696  -0.00624413        0            2.22045e-16
ACLine6                                                                                                                                             0                                    -0.0336848                                                                                                   0.0936656                    0.0891115          -0.151541   -0.0706019                        0.0637592          -0.0394314  -0.0274499         0            0
ACLine7                                                                                                                                             0                                    -0.047545                                                                                                    0.132206                     0.0106311          -0.213896   -0.0996523                        -0.666177          -0.0556562  -0.0387446         0            0
ACLine8                                                                                                                                             0                                    0.0888922                                                                                                    0.752822                     0.746268           0.399909    0.186314                          0.709779           0.104057    0.0724387          -2.22045e-16 0
ACLine9                                                                                                                                             0                                    -0.0076624                                                                                                   0.0213065                    0.15399            -0.0344716  -0.0160601                        -0.107362          -0.0089696  -0.00624413        0            -5.55112e-17
ACLine10                                                                                                                                            0                                    -0.100394                                                                                                    0.0837932                    0.0860151          0.203431    -0.299833                         0.0983846          -0.108169   -0.0191995         1.11022e-16  2.77556e-17
ACLine11                                                                                                                                            0                                    0.0552074                                                                                                    -0.153512                    -0.164621          0.248367    0.115712                          -0.226461          0.0646258   0.0449888          0            0
ACLine12                                                                                                                                            0                                    0.0115016                                                                                                    0.163385                     0.167717           0.396661    0.113518                          0.191836           0.00411232  -0.0532392         5.55112e-17  0
ACLine13                                                                                                                                            0                                    -0.0650628                                                                                                   0.0601652                    0.0617606          0.146067    0.503415                          0.0706422          -0.143077   -0.014321          0            -5.55112e-17
ACLine14                                                                                                                                            0                                    0.0370609                                                                                                    0.0151287                    0.0155298          0.0367289   0.131765                          0.0177631          0.0377265   -0.00767435        -1.38778e-17 -1.38778e-17
ACLine15                                                                                                                                            0                                    0.552894                                                                                                     0.0475155                    0.0487754          0.115357    0.456171                          0.0557896          0.72071     -0.0573856         -2.22045e-16 0
ACLine16                                                                                                                                            0                                    0.601457                                                                                                     0.226029                     0.232023           0.548746    0.701455                          0.265389           0.762548    0.881701           -8.88178e-16 0
ACLine17                                                                                                                                            0                                    1                                                                                                            1                            1                  1           1                                 1                  1           1                  1            -2.22045e-16
;



TABLE                                                                                                                                               FB_ACPTDF_ACEUR(LINES,RRR)                                                                                                                                                                            PTDF of the European network'
                                                                                                                                                    BE                                   DE4-S                                                                                                        DE4-W                        DE4-E       DE4-N      DK1                               FR          NL         PL
ACLine18                                                                                                                                            0                                    -0.0171705                                                                                                   -0.0115988                   -0.00825387 -0.0108202 -0.0108202                        -0.18389    -0.0068756 -0.00327068
ACLine19                                                                                                                                            0                                    -0.0796181                                                                                                   -0.276127                    -0.152372   -0.247322  -0.247322                         -0.0171775  -0.570899  -0.0603789
ACLine20                                                                                                                                            0                                    0.109519                                                                                                     -0.562711                    -0.274083   -0.49553   -0.49553                          0.0236285   -0.333567  -0.108608
ACLine21                                                                                                                                            0                                    0.0208217                                                                                                    -0.0247499                   -0.143962   -0.0524979 -0.0524979                        0.00449225  -0.0146714 -0.0570464
ACLine22                                                                                                                                            0                                    0.0747341                                                                                                    0.0504834                    0.0359247   0.0470947  0.0470947                         -0.199624   0.0299258  0.0142355
ACLine23                                                                                                                                            0                                    0.0198513                                                                                                    0.106995                     -0.283123   0.0161907  0.0161907                         0.00428288  0.0634251  -0.11219
ACLine24                                                                                                                                            0                                    0.0100498                                                                                                    0.0541666                    -0.143332   -0.759042  -0.759042                         0.00216822  0.0321091  -0.0567966
ACLine25                                                                                                                                            0                                    0.0796181                                                                                                    0.276127                     0.152372    0.247322   0.247322                          0.0171775   -0.429101  0.0603789
ACLine26                                                                                                                                            0                                    -0.0100498                                                                                                   -0.0541666                   0.143332    -0.240958  -0.240958                         -0.00216822 -0.0321091 0.0567966
ACLine27                                                                                                                                            0                                    0.024593                                                                                                     0.0661394                    0.208284    0.0992251  0.0992251                         0.00530589  0.0392064  -0.313725
ACLine28                                                                                                                                            0                                    0                                                                                                            0                            0           0          -1                                0           0          0
;


TABLE                                                                                                                                               FB_ACPTDF_ACBALT(LINES,RRR)                                                                                                                                                                           PTDF of the Baltic network'
                                                                                                                                                    EE                                   LT                                                                                                           LV
ACLine29                                                                                                                                            0                                    -1                                                                                                           -1
ACLine30                                                                                                                                            0                                    1                                                                                                            0
;



FB_ACPTDF('ACSCAND',LINES,RRR)                                                                                                                                                           =                                                                                                            FB_ACPTDF_ACSCAND(LINES,RRR)                                                          ;
FB_ACPTDF('ACEUR',LINES,RRR)                                                                                                                                                             =                                                                                                            FB_ACPTDF_ACEUR(LINES,RRR)                                                            ;
FB_ACPTDF('ACBALT',LINES,RRR)                                                                                                                                                            =                                                                                                            FB_ACPTDF_ACBALT(LINES,RRR)                                                           ;




















